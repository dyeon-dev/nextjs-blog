---
title: "블로그 게시글 조회수 기능 (Serverless DB)"
publishedAt: "2025-01-12"
summary: "Serverless DB를 활용해서 조회수 데이터 관리하기"
---

템플렛으로 시작한 블로그를 게시글 조회수 카운트 기능을 넣어 고도화시키도록 하겠다.

## 0. Vercel에서 해당 리포지토리 배포하기

Vercel에 배포하게 되면 Vercel에서 DB를 사용할 수 있다. 이 기능을 사용해서 조회수를 관리할 것이다.

## 1. Vercel CLI 설치하기

Vercel PostgreSQL과 연결하기 위해 Vercel CLI를 사용한다. 아래의 명령어로 Vercel CLI를 설치해준다.

```
pnpm i -g vercel
```

## 2. 대시보드에서 Storage 영역에서 데이터베이스로 Neon 선택

원래는 PostgresSQL로 하려했느나 공식문서를 참고한 결과, PostgresSQL는 Neon으로 통합되었다고 한다.

따라서 다음과 같은 이유로 Neon을 사용하였다.

> [기존 Vercel Postgres 저장소가 없는 경우 Neon Marketplace 통합을 사용하여 새 Postgres 저장소를 만들 수 있습니다. 기존 Vercel Postgres 저장소는 2024년 12월 첫째 주부터 Neon Serverless Postgres 제품 통합 으로 자동 전환 되며 2025년 1월 말까지 완료될 예정입니다.]

## 3. DB 생성 후 리포지토리와 연결하기 위해 Next.js 프레임워크로 단계를 수행

![5-1](/images/posts/1-next-js-blog/5-1.png)

<br />

---

## Conclusion

플러그인을 사용한다면, 편리한 점이 분명 있지만 **프로젝트 구조와 요구사항에 맞는 방식으로 선택**해야 한다.

또한, 주의할 점은 rehype-slug에서 생성된 id와 목차에서 생성된 href가 일치하도록 목차 생성 시에도 동일하게 슬러그를 적용해야 한다.

플러그인을 사용하는 것이 아닌, 커스텀한 방식으로 id를 생성하고 싶으면 정규표현식을 사용하면 된다. 다만, 슬러그 생성과 링크 추가, 코드 블록 처리 등을 직접 구현해야 한다.

주요 차이점은 다음 표와 같다.

<Table
  data={{
    headers: ["", "extractHeadings", "rehype-slug + rehype-autolink-headings"],
    rows: [
      ["헤딩 추출 방식", "정규표현식", "AST 변환 및 렌더링 단계"],
      ["슬러그 자동 생성", "직접 구현 필요", "자동으로 생성"],
      ["코드 블록 처리", "수동으로 제거", "자동으로 무시"],
      ["사용 단계", "MDX 콘텐츠 파싱 단계", "MDX 렌더링 단계"],
    ],
  }}
/>

rehype 공식문서에서는 추천하는 이유를 다음과 같이 설명하고 있다.

> _"remark와 rehype 플러그인은 MDX와 함께 사용할 때 그 진가를 발휘합니다. 이를 통해 기술 문서, 블로그 포스트, 교육 자료 등 다양한 온라인 자료를 더욱 효과적으로 작성하고 관리할 수 있습니다. Next.js에서 이러한 플러그인들을 적절히 활용하여 웹 프로젝트의 품질을 한 단계 끌어올려 보세요. "_
